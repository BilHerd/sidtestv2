100 REM SID2K TEST APPLICATION V2.01
110 REM FIXED REGISTER VALUE INPUT
120 V$="V2.01"
130 POKE 53280,0:POKE 53281,0:PRINT CHR$(147)
140 PRINT TAB(10);"SID2K TEST APPLICATION"
150 PRINT TAB(17);V$;TAB(27);"VOLUME OFF"
160 PRINT
170 PRINT "TEST MODE: FREQUENCY SWEEP"
180 PRINT "TEST RUNNING: STOPPED"
190 PRINT
200 PRINT " 1  START/STOP TEST"
210 PRINT " 2  RESET TEST"
220 PRINT " 3  CHANGE TEST"
230 PRINT " +  ADJUST VOLUME"
240 PRINT " R  ENTER REGISTER VALUE"
250 PRINT " 6  TOGGLE VOICE FOR TEST"
260 PRINT " $  TOGGLE TEST TONE (1KHZ)"
270 PRINT " D  SET DEFAULT VALUES"
280 PRINT
290 PRINT "-400 00 00 00 00 00 00 F0  V1 FREQ LO"
300 PRINT "-401 00 00 00 00 00 00 F0"
310 PRINT "-40- 00 00 00 0F FF FF 00"
320 PRINT "-415 00 00 00 FF FF 00"
330 PRINT " G:  00.00 00 00 00 00 00 00 00 00 00 00"
340 REM MAIN LOOP
350 GET K$
360 IF K$="" THEN 350
370 IF K$="1" THEN GOSUB 1000
380 IF K$="2" THEN GOSUB 1100
390 IF K$="3" THEN GOSUB 1200
400 IF K$="+" THEN GOSUB 1300
410 IF K$="6" THEN GOSUB 1400
420 IF K$="$" THEN GOSUB 1500
430 IF K$="D" OR K$="d" THEN GOSUB 500
435 IF K$="R" OR K$="r" THEN GOSUB 3000
440 IF K$=CHR$(13) THEN END
450 GOTO 350
500 REM *** DEFAULT VALUES SETUP (NEW IN V1.09) ***
510 REM VOICE 1 - SAWTOOTH
520 POKE 54272,0:REM FREQ LO
530 POKE 54273,16:REM FREQ HI (4096 HZ)
540 POKE 54274,0:REM PULSE LO
550 POKE 54275,8:REM PULSE HI (50%)
560 POKE 54276,33:REM SAWTOOTH + GATE ON
570 POKE 54277,0:REM ATTACK=0, DECAY=0
580 POKE 54278,249:REM SUSTAIN=15, RELEASE=9
590 REM VOICE 2 - TRIANGLE
600 POKE 54279,0:REM FREQ LO
610 POKE 54280,32:REM FREQ HI
620 POKE 54281,0:REM PULSE LO
630 POKE 54282,8:REM PULSE HI
640 POKE 54283,17:REM TRIANGLE + GATE ON
650 POKE 54284,0:REM ATTACK=0, DECAY=0
660 POKE 54285,249:REM SUSTAIN=15, RELEASE=9
670 REM VOICE 3 - PULSE
680 POKE 54286,0:REM FREQ LO
690 POKE 54287,64:REM FREQ HI
700 POKE 54288,0:REM PULSE LO
710 POKE 54289,8:REM PULSE HI (50%)
720 POKE 54290,65:REM PULSE + GATE ON
730 POKE 54291,0:REM ATTACK=0, DECAY=0
740 POKE 54292,249:REM SUSTAIN=15, RELEASE=9
750 REM FILTER & VOLUME
760 POKE 54293,0:REM FILTER CUTOFF LO
770 POKE 54294,128:REM FILTER CUTOFF HI (MIDPOINT)
780 POKE 54295,247:REM ROUTE ALL VOICES TO FILTER, RESONANCE=15
790 POKE 54296,63:REM LOW-PASS FILTER + MAX VOL + EXT AUDIO ON
800 REM UPDATE DISPLAY
810 PRINT CHR$(19)
820 FOR I=1 TO 2:PRINT CHR$(17):NEXT
830 PRINT TAB(27);"VOLUME ON "
840 GOSUB 2000:REM UPDATE REGISTER DISPLAY
850 RETURN
1000 REM START/STOP TEST
1010 REM TOGGLE TEST STATE
1020 RETURN
1100 REM RESET TEST
1110 FOR I=54272 TO 54296:POKE I,0:NEXT
1120 PRINT CHR$(19)
1130 FOR I=1 TO 2:PRINT CHR$(17):NEXT
1140 PRINT TAB(27);"VOLUME OFF"
1150 GOSUB 2000:REM UPDATE DISPLAY
1160 RETURN
1200 REM CHANGE TEST MODE
1210 REM CYCLE THROUGH TEST MODES
1220 RETURN
1300 REM ADJUST VOLUME
1310 V=PEEK(54296) AND 15
1320 V=V+1:IF V>15 THEN V=0
1330 POKE 54296,(PEEK(54296) AND 240) OR V
1340 RETURN
1400 REM TOGGLE VOICE
1410 REM TOGGLE VOICE SELECTION
1420 RETURN
1500 REM TOGGLE TEST TONE
1510 REM TOGGLE 1KHZ TEST TONE
1520 RETURN
2000 REM UPDATE REGISTER DISPLAY
2010 PRINT CHR$(19)
2020 FOR L=1 TO 9:PRINT CHR$(17):NEXT
2030 REM UPDATE -400 LINE
2040 PRINT "-400 ";
2050 FOR I=0 TO 6
2060 V=PEEK(54272+I):GOSUB 2500:PRINT H$;" ";
2070 NEXT:PRINT "F0  V1 FREQ LO"
2080 REM UPDATE -401 LINE
2090 PRINT "-401 ";
2100 FOR I=7 TO 13
2110 V=PEEK(54272+I):GOSUB 2500:PRINT H$;" ";
2120 NEXT:PRINT "F0"
2130 REM UPDATE -40- LINE
2140 PRINT "-40- ";
2150 FOR I=14 TO 20
2160 V=PEEK(54272+I):GOSUB 2500:PRINT H$;" ";
2170 NEXT:PRINT "00"
2180 REM UPDATE -415 LINE
2190 PRINT "-415 ";
2200 FOR I=21 TO 24
2210 V=PEEK(54272+I):GOSUB 2500:PRINT H$;" ";
2220 NEXT:PRINT "FF FF 00"
2230 RETURN
2500 REM CONVERT BYTE TO HEX STRING
2510 H$=""
2520 N1=INT(V/16):N2=V-N1*16
2530 IF N1<10 THEN H$=H$+CHR$(48+N1):GOTO 2550
2540 H$=H$+CHR$(65+N1-10)
2550 IF N2<10 THEN H$=H$+CHR$(48+N2):GOTO 2570
2560 H$=H$+CHR$(65+N2-10)
2570 RETURN
3000 REM REGISTER VALUE INPUT (FIX FOR SINGLE KEY PROBLEM)
3010 PRINT CHR$(19):FOR I=1 TO 23:PRINT CHR$(17):NEXT
3020 PRINT "ENTER REGISTER (0-24): ";
3030 INPUT R
3040 IF R<0 OR R>24 THEN PRINT "INVALID":GOTO 3080
3050 PRINT "ENTER VALUE (0-255): ";
3060 INPUT V
3070 IF V>=0 AND V<=255 THEN POKE 54272+R,V
3080 GOSUB 2000:REM UPDATE DISPLAY
3090 RETURN